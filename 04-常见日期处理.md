# 03-常见日期统计

## 获取日期信息

| A1范例                  | 功能                         | 公式             | 效果 |
| ----------------------- | ---------------------------- | ---------------- | ---- |
| **`2020/1/1 10:20:30`** | 返回年份                     | `=YEAR(A1)`      | 2020 |
|                         | 返回月份                     | `=MONTH(A1)`     | 1    |
|                         | 返回天数                     | `=DAY(A1)`       | 1    |
|                         | 返回星期几（2：周一从1开始） | `=WEEKDAY(A1,2)` | 3    |
|                         | 返回小时                     | `=HOUR(A1)`      | 10   |
|                         | 返回分钟                     | `=MINUTE(A1)`    | 20   |
|                         | 返回秒                       | `=SECOND(A1)`    | 30   |

- 其他常用日期函数：
  - 获取系统当前时间：`=NOW()`
  - 获取系统当天日期：`=TODAY()`
  - 根据年月日拼接日期信息：`=DATE("年","月","日")`
  - 根据时分秒拼接时间数据：`=TIME("时","分","秒")`

<br/>

------

## 日期数据转文本信息

| A1范例         | 功能           | 公式                                                | 效果       |
| -------------- | -------------- | --------------------------------------------------- | ---------- |
| **`2020/1/1`** | 年/月/日       | `=TEXT(A1,"yyyy/mm/dd")`                            | 2020/01/01 |
|                | 年-月-日       | `=TEXT(A1,"yyyy-mm-dd")`                            | 2020-01-01 |
|                | 年月日         | `=TEXT(A1,"emmdd")`                                 | 20200101   |
|                | 年月           | `=TEXT(A1,"yyyy年m月")`                             | 2020年1月  |
|                | 年             | `=TEXT(A1,"yyyy")`                                  | 2020       |
|                | 年(末两位缩写) | `=TEXT(A1,"yy")`                                    | 20         |
|                | 季度           | `="Q"&LEN(2^MONTH(A1))`                             | Q1         |
|                | 月             | `=TEXT(A1,"mm")`                                    | 01         |
|                | 月(英文缩写)   | `=TEXT(A1,"mmm")`                                   | Jan        |
|                | 月(英文)       | `=TEXT(A1,"mmmm")`                                  | January    |
|                | 月份的上中下旬 | `=LOOKUP(DAY(A1),{0,11,21},{"上旬","中旬","下旬"})` | 上旬       |
|                | 星期(中文缩写) | `=TEXT(A1,"aaa")`                                   | 三         |
|                | 星期(中文)     | `=TEXT(A1,"aaaa")`                                  | 星期三     |
|                | 星期(英文缩写) | `=TEXT(A1,"ddd")`                                   | Wed        |
|                | 星期(英文)     | `=TEXT(A1,"dddd")`                                  | Wednesday  |

<br/>

------

## 文本与时间日期的转换

> 注意：仅对**文本格式的时间**才有效。

| A1范例             | 功能             | 公式                                                      | 效果     |
| ------------------ | ---------------- | --------------------------------------------------------- | -------- |
| **`2020年1月1日`** | 字符串转日期格式 | `=DATEVALUE(A1)`                                          | 2020/1/1 |
| **`10时20分`**     | 字符串转时间格式 | `=TIMEVALUE(SUBSTITUTE(SUBSTITUTE(A1,"分",""),"时",":"))` | 10:20:00 |

<br/>

------

## 日期计算

DATEDIF()、DAYS()

EADATE()、DATESTRING()、

<br/>

## 文本与日期、时间格式之间的转换技巧，简单易懂，办公必备

https://mp.weixin.qq.com/s?__biz=MzI0MjgyMTEyMQ==&mid=2247490982&idx=1&sn=5065ba7a44837515e792cb10a3fa4959&chksm=e9772cc8de00a5de2c86aebe636843c6f207b510c5ada83182faab7a785501c9fd48ecf8c45c&mpshare=1&srcid=&sharer_sharetime=1588548515374&sharer_shareid=f44dfb8d1ce5101576067f9cd135d493&from=singlemessage&scene=1&subscene=10000&clicktime=1588551283&enterid=1588551283&ascene=1&devicetype=android-27&version=27000e37&nettype=WIFI&abtest_cookie=AAACAA%3D%3D&lang=zh_CN&exportkey=AW5fnQrbS%2FSuo58FLhhdZdY%3D&pass_ticket=DwzKn7%2Bp7KUjszFf1HENT5Jvl5Vdf%2BIxpn0PkJ2crl5To6Ycr0DYxjWvzgVtT9qT&wx_header=1
