# 02-字符串处理

- [截取与合并字符串](#截取与合并字符串)  <sup>LEFT()、RIGHT()、MID()、CONCATNATE()、&</sup>
- [根据特定符号截取字符串](#根据特定符号截取字符串)  <sup>FIND()</sup>
- [提取字符串中的数值](#提取字符串中的数值)  <sup>LEN()、LENB()、MIDB()、SEARCHB()</sup>
- [调整字符串格式](#调整字符串格式)  <sup>VALUE()、CLEAN()</sup>
- [计算字符串中特殊字符的个数](#计算字符串中特殊字符的个数)  <sup>SUBSTITUTE()</sup>
- [字符串比较](#字符串比较)  <sup>EXACT()、=</sup>
- [身份证号码常用处理](#身份证号码常用处理)  <sup>TEXT()、DATEDIF()</sup>

<br/>

## 截取与合并字符串

| A1范例         | 功能                               | 公式           | 效果 |
| -------------- | ---------------------------------- | -------------- | ---- |
| **`ABCD-EFG`** | 截取左侧开始的前4个字符            | `=LEFT(A1,4)`  | ABCD |
|                | 截取右侧开始的前3个字符            | `=RIGHT(A1,3)` | EFG  |
|                | 从中间第4个字符开始，截取后3个字符 | `=MID(A1,4,3)` | D-E  |

<br/>

| A1范例     | B1范例 | 公式                     | 效果     |
| ---------- | ------ | ------------------------ | -------- |
| **`ABCD`** | `EFG`  | `=A1&"-"&B1`             | ABCD-EFG |
|            |        | `=CONCATNATE(A1,"-",B1)` | ABCD-EFG |

<br/>

------

## 根据特定符号截取字符串

| A1范例         | 功能                    | 公式                        | 效果 |
| -------------- | ----------------------- | --------------------------- | ---- |
| **`ABCD-EFG`** | 返回"-"在字符的位置     | `=FIND("-",A1)`             | 5    |
|                | 返回"-"字符前的所有字符 | `=LEFT(A1,FIND("-",A1)-1)`  | ABCD |
|                | 返回"-"字符前3位        | `=MID(A1,FIND("-",A1)-3,3)` | BCD  |
|                | 返回"-"字符后的所有字符 | `=RIGHT(A1,FIND("-",A1)-2)` | EFG  |
|                | 返回"-"字符后2位        | `=MID(A1,FIND("-",A1)+1,2)` | EF   |

<br/>

------

## 提取字符串中的数值

| A1案例                | 功能           | 公式                                   | 效果        |
| --------------------- | -------------- | -------------------------------------- | ----------- |
| **`小明12222222222`** | 提取中文字     | `=LEFT(A1,LENB(A1)-LEN(A1))`           | 小明        |
|                       | 提取数值-方法1 | `=MID(A1,LENB(A1)-LEN(A1)+1,LENB(A1))` | 12222222222 |
|                       | 提取数值-方法2 | `=-LOOKUP(1,-RIGHT(A1,ROW($1:$99)))`   | 12222222222 |

<br/>

| A1范例         | 功能                     | 公式                                             | 效果 |
| -------------- | ------------------------ | ------------------------------------------------ | ---- |
| **`话费50元`** | 仅限中文字符的第一个数字 | `=MIDB(A1,SEARCHB("?",A1),2*LEN(A1)-LENB(A1))*1` | 50   |

<br/>

------

## 调整字符串格式

| A1范例            | 功能                             | 公式                     | 效果         |
| ----------------- | -------------------------------- | ------------------------ | ------------ |
| **`1.23457E+11`** | 将科学计数的数值改为**文本格式** | `=""&A1`                 | 123456789123 |
|                   | 删除数据中的**隐藏双引号和空格** | `=""&(VALUE(CLEAN(A1)))` | 123456789123 |

<br/>

------

## 计算字符串中特殊字符的个数

| A1                  | 功能                         | 公式                                    | 效果 |
| ------------------- | ---------------------------- | --------------------------------------- | ---- |
| **`123???789`**     | 计算单元格内特定符号的数量   | `=LEN(A1)-LEN(SUBSTITUTE(A1,"???",""))` | 3    |
| **`小A，小B，小C`** | 计算单元格被符号分隔开的数量 | `=LEN(A1)-LEN(SUBSTITUTE(A1,"，",))+1`  | 3    |

<br/>

------

## 字符串比较

| A1范例     | B1范例 | 公式                              | 效果  |
| ---------- | :----- | --------------------------------- | ----- |
| **`ABCD`** | `abcd` | 不区分大小写判断：`=A1=B1`        | TRUE  |
|            |        | 区分大小写的判断：`=EXACT(A1,B1)` | FALSE |

<br/>

------

## 身份证号码常用处理

| A1范例                   | 功能           | 公式                                                 | 效果       |
| ------------------------ | -------------- | ---------------------------------------------------- | ---------- |
| **`329297198001019876`** | 提取生日       | `=TEXT(MID(A1,7,8),"00-00-00")`                      | 1980-01-01 |
|                          | 提取性别       | `=IF(MOD(MID(A1,17,1),2),"男","女")`                 | 男         |
|                          | 计算年龄       | `=DATEDIF(TEXT(MID(A1,7,8),"00-00-00"),TODAY(),"y")` | 40         |
|                          | 同列中是否重复 | `=IF(COUNTIF(A:A,""&A1)>1,"重复","")`                | 重复       |

<br/>

| [**< <目录**](./README.md) | [**03-日期处理>**](./03-日期处理.md) | [**返回顶部 ↑**](#02-字符串处理) |