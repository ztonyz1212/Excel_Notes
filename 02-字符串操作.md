

# 02-字符串操作

## 常用字符串截取

| A1             | 功能                               | 公式           | 效果 |
| -------------- | ---------------------------------- | -------------- | ---- |
| **`ABCD-EFG`** | 截取左侧开始的前4个字符            | `=LEFT(A1,4)`  | ABCD |
|                | 截取右侧开始的前3个字符            | `=RIGHT(A1,3)` | EFG  |
|                | 从中间第4个字符开始，截取后3个字符 | `=MID(A1,4,3)` | D-E  |



------

## 从指定位置开始截取字符串

| A1             | 功能                    | 公式                        | 效果 |
| -------------- | ----------------------- | --------------------------- | ---- |
| **`ABCD-EFG`** | 返回"-"在字符的位置     | `=FIND("-",A1)`             | 5    |
|                | 返回"-"字符前的所有字符 | `=LEFT(A1,FIND("-",A1)-1)`  | ABCD |
|                | 返回"-"字符前3位        | `=MID(A1,FIND("-",A1)-3,3)` | BCD  |
|                | 返回"-"字符后的所有字符 | `=RIGHT(A1,FIND("-",A1)-2)` | EFG  |
|                | 返回"-"字符后2位        | `=MID(A1,FIND("-",A1)+1,2)` | EF   |



------

## 提取字符串中的数值

| A1       | 功能                     | 公式                                             | 效果 |
| -------- | ------------------------ | ------------------------------------------------ | ---- |
| 话费50元 | 仅限中文字符的第一个数字 | `=MIDB(A1,SEARCHB("?",A1),2*LEN(A1)-LENB(A1))*1` | 50   |



------

## 字符串格式调整

| A1                | 功能                           | 公式                     | 效果         |
| ----------------- | ------------------------------ | ------------------------ | ------------ |
| **`1.23457E+11`** | 将科学计数的数值改为文本格式   | `=""&A1`                 | 123456789123 |
|                   | 删除单元格内的隐藏双引号和空格 | `=""&(VALUE(CLEAN(A1)))` | 123456789123 |



------

## 计算字符串中特殊字符的个数

| A1              | 功能                  | 公式                                  | 效果 |
| --------------- | --------------------- | ------------------------------------- | ---- |
| **`123???789`** | 计算单元格内"?"的数量 | `=LEN(A1)-LEN(SUBSTITUTE(A1,"?",""))` | 3    |









## 身份证号码处理



关于身份证号码的这8个技巧，职场的你必须掌握！-Excel函数公式
https://mp.weixin.qq.com/s?__biz=MzI0MjgyMTEyMQ==&mid=2247490914&idx=1&sn=47730051d33c7e6bb38f4a90f6e5fe7a&chksm=e9772c0cde00a51a4aada6325b1ddb4b145e63bf899365c101aac47f74fadaf075fc512254e2&mpshare=1&srcid=0422tYTjt6GK6l44ebSclu60&sharer_sharetime=1587562829319&sharer_shareid=f44dfb8d1ce5101576067f9cd135d493&from=singlemessage&scene=1&subscene=10000&clicktime=1587779661&enterid=1587779661&ascene=1&devicetype=android-27&version=27000d39&nettype=WIFI&abtest_cookie=AAACAA%3D%3D&lang=zh_CN&exportkey=AVZKAo909r4LgnQsuiKNSPw%3D&pass_ticket=tjBq1Fc%2BRjJplU%2BGswpQovR2Kc9qvdzF3U5%2F0la6T1TPlCV4WnsGrasjeclHP0cf&wx_header=1