

# 02-字符串操作

## 字符串截取

| A1             | 功能                               | 公式           | 效果 |
| -------------- | ---------------------------------- | -------------- | ---- |
| **`ABCD-EFG`** | 截取左侧开始的前4个字符            | `=LEFT(A1,4)`  | ABCD |
|                | 截取右侧开始的前3个字符            | `=RIGHT(A1,3)` | EFG  |
|                | 从中间第4个字符开始，截取后3个字符 | `=MID(A1,4,3)` | D-E  |

<br/>

------

## 根据特定符号截取字符串

| A1             | 功能                    | 公式                        | 效果 |
| -------------- | ----------------------- | --------------------------- | ---- |
| **`ABCD-EFG`** | 返回"-"在字符的位置     | `=FIND("-",A1)`             | 5    |
|                | 返回"-"字符前的所有字符 | `=LEFT(A1,FIND("-",A1)-1)`  | ABCD |
|                | 返回"-"字符前3位        | `=MID(A1,FIND("-",A1)-3,3)` | BCD  |
|                | 返回"-"字符后的所有字符 | `=RIGHT(A1,FIND("-",A1)-2)` | EFG  |
|                | 返回"-"字符后2位        | `=MID(A1,FIND("-",A1)+1,2)` | EF   |

<br/>

------

## 提取字符串中的数值

| A1             | 功能                     | 公式                                             | 效果 |
| -------------- | ------------------------ | ------------------------------------------------ | ---- |
| **`话费50元`** | 仅限中文字符的第一个数字 | `=MIDB(A1,SEARCHB("?",A1),2*LEN(A1)-LENB(A1))*1` | 50   |

<br/>

------

## 调整字符串格式

| A1                | 功能                             | 公式                     | 效果         |
| ----------------- | -------------------------------- | ------------------------ | ------------ |
| **`1.23457E+11`** | 将科学计数的数值改为**文本格式** | `=""&A1`                 | 123456789123 |
|                   | 删除数据中的**隐藏双引号和空格** | `=""&(VALUE(CLEAN(A1)))` | 123456789123 |

<br/>

------

## 计算字符串中特殊字符的个数

| A1              | 功能                  | 公式                                  | 效果 |
| --------------- | --------------------- | ------------------------------------- | ---- |
| **`123???789`** | 计算单元格内"?"的数量 | `=LEN(A1)-LEN(SUBSTITUTE(A1,"?",""))` | 3    |

<br/>

------

## 身份证号码处理

| A1                       | 功能                           | 公式                                                 | 效果       |
| ------------------------ | ------------------------------ | ---------------------------------------------------- | ---------- |
| **`329297198001019876`** | 根据身份证号提取生日           | `=TEXT(MID(A1,7,8),"00-00-00")`                      | 1980-01-01 |
|                          | 根据身份证号提取性别           | `=IF(MOD(MID(A1,17,1),2),"男","女")`                 | 男         |
|                          | 根据身份证号计算年龄           | `=DATEDIF(TEXT(MID(A1,7,8),"00-00-00"),TODAY(),"y")` | 40         |
|                          | 判断同一列中有无重复的身份证号 | `=IF(COUNTIF(A:A,""&A1)>1,"重复","")`                | 重复       |